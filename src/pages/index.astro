---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import AdSense from '../components/AdSense.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import { getCollection } from 'astro:content';

// Lấy 3 bài viết gần đây nhất
const posts = await getCollection('blog');
const recentPosts = posts
	.sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime())
	.slice(0, 3);
---

<!doctype html>
<html lang="vi">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main class="stories-layout">
			<div class="container">
				<!-- Featured Story -->
				<article class="featured-story">
					<div class="story-image">
						<img src="/blog-placeholder-1.jpg" alt="AI Trends 2024" />
						<div class="category-tag ai-tag">AI</div>
					</div>
					<div class="story-content">
						<h1>XU HƯỚNG AI 2024: NHỮNG ĐỘT PHÁ MỚI NHẤT TỪ CÁC DIỄN ĐÀN CÔNG NGHỆ</h1>
						<p>Khám phá những xu hướng AI mới nhất năm 2024 từ Reddit, Hacker News, Medium và các diễn đàn công nghệ hàng đầu. Từ GPT-5, Claude 3.5 đến các ứng dụng thực tế đang hot. Trí tuệ nhân tạo đang phát triển với tốc độ chóng mặt, và năm 2024 chứng kiến nhiều đột phá đáng kinh ngạc.</p>
						<div class="story-meta">
							<span class="story-date">23/12/2024</span>
							<a href="/blog/ai-trends-2024" class="read-more">Đọc thêm →</a>
						</div>
					</div>
				</article>

				<!-- Stories Grid -->
				<div class="stories-grid">
					{recentPosts.map((post, index) => {
						const categories = ['Web Dev', 'AI/ML', 'Cloud', 'Mobile', 'DevOps', 'Data'];
						const category = categories[index % categories.length];
						const categoryClass = category.toLowerCase().replace(/[^a-z0-9]/g, '');
						
						return (
							<article class="story-card">
								<div class="story-image">
									<img src={post.data.heroImage} alt={post.data.title} />
									<div class={`category-tag ${categoryClass}-tag`}>{category}</div>
								</div>
								<div class="story-content">
									<h3>{post.data.title.toUpperCase()}</h3>
									<p>{post.data.description}</p>
									<div class="story-meta">
										<span class="story-date">{new Date(post.data.pubDate).toLocaleDateString('vi-VN')}</span>
										<a href={`/blog/${post.slug}`} class="read-more">Đọc thêm →</a>
									</div>
								</div>
							</article>
						);
					})}
				</div>

				<!-- AdSense Banner -->
				<AdSense 
					adSlot="1234567890" 
					adFormat="auto" 
					className="mobile-banner"
				/>

				<!-- More Stories Button -->
				<div class="view-all-stories">
					<a href="/blog" class="btn-primary">Xem tất cả bài viết</a>
				</div>
			</div>
		</main>
		<Footer />

		<style>
			.container {
				max-width: 1200px;
				margin: 0 auto;
				padding: 0 20px;
			}

			/* Stories Layout */
			.stories-layout {
				background: #f8f9fa;
				min-height: 100vh;
				padding: 40px 0;
			}

			/* Featured Story */
			.featured-story {
				background: white;
				border-radius: 16px;
				overflow: hidden;
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
				margin-bottom: 40px;
				transition: all 0.3s ease;
			}

			.featured-story:hover {
				transform: translateY(-4px);
				box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
			}

			.featured-story .story-image {
				position: relative;
				height: 400px;
				overflow: hidden;
			}

			.featured-story .story-image img {
				width: 100%;
				height: 100%;
				object-fit: cover;
			}

			.featured-story .story-content {
				padding: 40px;
			}

			.featured-story h1 {
				font-size: 2.2rem;
				font-weight: 800;
				line-height: 1.2;
				margin-bottom: 20px;
				color: #333;
				letter-spacing: -0.02em;
			}

			.featured-story p {
				font-size: 1.1rem;
				line-height: 1.6;
				color: #666;
				margin-bottom: 30px;
			}

			/* Stories Grid */
			.stories-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
				gap: 30px;
				margin-bottom: 40px;
			}

			.story-card {
				background: white;
				border-radius: 16px;
				overflow: hidden;
				box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
				transition: all 0.3s ease;
			}

			.story-card:hover {
				transform: translateY(-3px);
				box-shadow: 0 6px 25px rgba(0, 0, 0, 0.1);
			}

			.story-image {
				position: relative;
				height: 200px;
				overflow: hidden;
			}

			.story-image img {
				width: 100%;
				height: 100%;
				object-fit: cover;
			}

			.story-content {
				padding: 24px;
			}

			.story-content h3 {
				font-size: 1.1rem;
				font-weight: 700;
				line-height: 1.3;
				margin-bottom: 12px;
				color: #333;
				letter-spacing: -0.01em;
			}

			.story-content p {
				font-size: 0.95rem;
				line-height: 1.5;
				color: #666;
				margin-bottom: 20px;
			}

			/* Category Tags */
			.category-tag {
				position: absolute;
				top: 16px;
				left: 16px;
				padding: 6px 12px;
				border-radius: 20px;
				font-size: 0.8rem;
				font-weight: 600;
				color: white;
				text-transform: uppercase;
				letter-spacing: 0.5px;
			}

			.ai-tag { background: linear-gradient(135deg, #667eea, #764ba2); }
			.webdev-tag { background: linear-gradient(135deg, #ff6b6b, #ff8e8e); }
			.cloud-tag { background: linear-gradient(135deg, #4ecdc4, #44a08d); }
			.mobile-tag { background: linear-gradient(135deg, #f093fb, #f5576c); }
			.devops-tag { background: linear-gradient(135deg, #4facfe, #00f2fe); }
			.data-tag { background: linear-gradient(135deg, #43e97b, #38f9d7); }

			/* Story Meta */
			.story-meta {
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.story-date {
				font-size: 0.85rem;
				color: #999;
				font-weight: 500;
			}

			.read-more {
				color: #667eea;
				text-decoration: none;
				font-weight: 600;
				font-size: 0.9rem;
				transition: all 0.3s ease;
			}

			.read-more:hover {
				color: #5a6fd8;
				text-decoration: underline;
			}

			/* View All Button */
			.view-all-stories {
				text-align: center;
				margin-top: 40px;
			}

			.btn-primary {
				background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				color: white;
				padding: 16px 32px;
				border-radius: 12px;
				text-decoration: none;
				font-weight: 600;
				font-size: 1rem;
				transition: all 0.3s ease;
				box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
				display: inline-block;
			}

			.btn-primary:hover {
				transform: translateY(-2px);
				box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
			}

			/* Responsive Design */
			@media (max-width: 768px) {
				.container {
					padding: 0 16px;
				}

				.stories-layout {
					padding: 20px 0;
				}

				.featured-story .story-image {
					height: 250px;
				}

				.featured-story .story-content {
					padding: 24px;
				}

				.featured-story h1 {
					font-size: 1.6rem;
					margin-bottom: 16px;
				}

				.featured-story p {
					font-size: 1rem;
					margin-bottom: 24px;
				}

				.stories-grid {
					grid-template-columns: 1fr;
					gap: 20px;
					margin-bottom: 30px;
				}

				.story-image {
					height: 180px;
				}

				.story-content {
					padding: 20px;
				}

				.story-content h3 {
					font-size: 1rem;
					margin-bottom: 10px;
				}

				.story-content p {
					font-size: 0.9rem;
					margin-bottom: 16px;
				}

				.category-tag {
					top: 12px;
					left: 12px;
					padding: 4px 10px;
					font-size: 0.75rem;
				}
			}

			@media (max-width: 480px) {
				.featured-story h1 {
					font-size: 1.4rem;
				}

				.featured-story .story-content {
					padding: 20px;
				}

				.story-content h3 {
					font-size: 0.95rem;
				}

				.story-meta {
					flex-direction: column;
					align-items: flex-start;
					gap: 8px;
				}
			}
		</style>
	</body>
</html>
